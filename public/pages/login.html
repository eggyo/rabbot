<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>ไอ้แดง Dang-Reply Login</title>

  <!-- Bootstrap Core CSS -->
  <link href="../public/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- MetisMenu CSS -->
  <link href="../public/vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link href="../public/dist/css/sb-admin-2.css" rel="stylesheet">

  <!-- Custom Fonts -->
  <link href="../public/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

  <div class="container">
    <div class="row">
      <div class="col-md-4 col-md-offset-4">
        <div class="login-panel panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Please Sign In</h3>
          </div>
          <div class="panel-body">
            <form role="form">
              <fieldset>
                <!--
                <fb:login-button size="large" auto_logout_link="true" scope="public_profile,email,manage_pages,publish_pages,read_page_mailboxes,pages_show_list" onlogin="checkLoginState();">
                </fb:login-button>
                 -->
                <div scope="public_profile,email,manage_pages,pages_show_list,read_page_mailboxes,publish_pages" class="fb-login-button" data-max-rows="1" data-size="large" data-button-type="continue_with" data-show-faces="false" data-auto-logout-link="false" data-use-continue-as="false"></div>
                <!--<button id="loginBtn" type="button" onclick="fb_login()" class="btn btn-primary">Login</button>-->

              </fieldset>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="fb-root"></div>

  <script src="../js/appEnv.js"></script>
  <script>
    function fb_login() {
      window.location.href = 'https://www.facebook.com/'+ config.GRAPH_API_VER + '/dialog/oauth?client_id=' + config.FB_CLIENT_ID  + '&redirect_uri=' +  config.SECURE_SERVER_URL + '/&scope=public_profile,email,manage_pages,pages_show_list,read_page_mailboxes,publish_pages'
    }

    function statusChangeCallback(response) {
      if (response.status === 'connected') {
        // Logged into your app and Facebook.
        window.location.href = "index.html"

      } else {
        //alert(JSON.stringify(response));

      }
    }

    function checkLoginState() {
      FB.getLoginStatus(function(response) {
        statusChangeCallback(response);
      });
    }

    window.onload = function() {

    };

    window.fbAsyncInit = function() {
      FB.init({
        appId: config.FB_CLIENT_ID,
        cookie: true, // enable cookies to allow the server to access
        xfbml: true, // parse social plugins on this page
        version: config.GRAPH_API_VER // use graph api version 2.10
      });

      FB.Event.subscribe('auth.authResponseChange', function(response) {
        if (response.status === 'connected') {
          window.location.href = "index.html"
        } else if (response.status === 'not_authorized') {
          //FB.login();
          alert("not_authorized");
        } else {
          //FB.login();
          //  alert("else");

        }
      });
      /*

            FB.getLoginStatus(function(response) {
              statusChangeCallback(response);
            });*/

    };
    /*
        (function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) {
            return;
          }
          js = d.createElement(s);
          js.id = id;
          js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.12&appId=332240913889202";
          js.async = true;
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    */

    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) {
        return;
      }
      js = d.createElement(s);
      js.id = id;
      js.async = true;
      js.src = "https://connect.facebook.net/en_US/sdk.js";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

  </script>



  <!-- jQuery -->
  <script src="../public/vendor/jquery/jquery.min.js"></script>

  <!-- Bootstrap Core JavaScript -->
  <script src="../public/vendor/bootstrap/js/bootstrap.min.js"></script>

  <!-- Metis Menu Plugin JavaScript -->
  <script src="../public/vendor/metisMenu/metisMenu.min.js"></script>

  <!-- Custom Theme JavaScript -->
  <script src="../public/dist/js/sb-admin-2.js"></script>

</body>

</html>
